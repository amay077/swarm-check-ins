var ue=Object.defineProperty;var ae=(t,e,n)=>e in t?ue(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var x=(t,e,n)=>(ae(t,typeof e!="symbol"?e+"":e,n),n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const c of r)if(c.type==="childList")for(const s of c.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&o(s)}).observe(document,{childList:!0,subtree:!0});function n(r){const c={};return r.integrity&&(c.integrity=r.integrity),r.referrerPolicy&&(c.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?c.credentials="include":r.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function o(r){if(r.ep)return;r.ep=!0;const c=n(r);fetch(r.href,c)}})();function g(){}function ce(t){return t()}function G(){return Object.create(null)}function R(t){t.forEach(ce)}function se(t){return typeof t=="function"}function W(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function fe(t){return Object.keys(t).length===0}function d(t,e){t.appendChild(e)}function k(t,e,n){t.insertBefore(e,n||null)}function b(t){t.parentNode&&t.parentNode.removeChild(t)}function de(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function p(t){return document.createElement(t)}function A(t){return document.createTextNode(t)}function I(){return A(" ")}function pe(){return A("")}function J(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function $(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function _e(t){return Array.from(t.childNodes)}function j(t,e){e=""+e,t.data!==e&&(t.data=e)}let F;function N(t){F=t}function he(){if(!F)throw new Error("Function called outside component initialization");return F}function me(t){he().$$.on_mount.push(t)}const P=[],Y=[];let L=[];const ee=[],ge=Promise.resolve();let q=!1;function $e(){q||(q=!0,ge.then(ie))}function Z(t){L.push(t)}const M=new Set;let T=0;function ie(){if(T!==0)return;const t=F;do{try{for(;T<P.length;){const e=P[T];T++,N(e),be(e.$$)}}catch(e){throw P.length=0,T=0,e}for(N(null),P.length=0,T=0;Y.length;)Y.pop()();for(let e=0;e<L.length;e+=1){const n=L[e];M.has(n)||(M.add(n),n())}L.length=0}while(P.length);for(;ee.length;)ee.pop()();q=!1,M.clear(),N(t)}function be(t){if(t.fragment!==null){t.update(),R(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Z)}}function ye(t){const e=[],n=[];L.forEach(o=>t.indexOf(o)===-1?e.push(o):n.push(o)),n.forEach(o=>o()),L=e}const B=new Set;let S;function ke(){S={r:0,c:[],p:S}}function we(){S.r||R(S.c),S=S.p}function D(t,e){t&&t.i&&(B.delete(t),t.i(e))}function O(t,e,n,o){if(t&&t.o){if(B.has(t))return;B.add(t),S.c.push(()=>{B.delete(t),o&&(n&&t.d(1),o())}),t.o(e)}else o&&o()}function te(t){return(t==null?void 0:t.length)!==void 0?t:Array.from(t)}function le(t){t&&t.c()}function X(t,e,n){const{fragment:o,after_update:r}=t.$$;o&&o.m(e,n),Z(()=>{const c=t.$$.on_mount.map(ce).filter(se);t.$$.on_destroy?t.$$.on_destroy.push(...c):R(c),t.$$.on_mount=[]}),r.forEach(Z)}function K(t,e){const n=t.$$;n.fragment!==null&&(ye(n.after_update),R(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function ve(t,e){t.$$.dirty[0]===-1&&(P.push(t),$e(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function Q(t,e,n,o,r,c,s,f=[-1]){const i=F;N(t);const l=t.$$={fragment:null,ctx:[],props:c,update:g,not_equal:r,bound:G(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(i?i.$$.context:[])),callbacks:G(),dirty:f,skip_bound:!1,root:e.target||i.$$.root};s&&s(l.root);let u=!1;if(l.ctx=n?n(t,e.props||{},(a,h,...y)=>{const C=y.length?y[0]:h;return l.ctx&&r(l.ctx[a],l.ctx[a]=C)&&(!l.skip_bound&&l.bound[a]&&l.bound[a](C),u&&ve(t,a)),h}):[],l.update(),u=!0,R(l.before_update),l.fragment=o?o(l.ctx):!1,e.target){if(e.hydrate){const a=_e(e.target);l.fragment&&l.fragment.l(a),a.forEach(b)}else l.fragment&&l.fragment.c();e.intro&&D(t.$$.fragment),X(t,e.target,e.anchor),ie()}N(i)}class V{constructor(){x(this,"$$");x(this,"$$set")}$destroy(){K(this,1),this.$destroy=g}$on(e,n){if(!se(n))return g;const o=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return o.push(n),()=>{const r=o.indexOf(n);r!==-1&&o.splice(r,1)}}$set(e){this.$$set&&!fe(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Ce="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Ce);const Ee={CLIENT_ID:"UBWPEWEM3L1XHICEZ0TJWOHFQ3QZ0KC3XZPHUXRRVWL044ZU",REDIRECT_URI:"https://amay077.github.io/swarm-check-ins/#/auth",API_ENDPOINT:"https://swarm-check-ins-api.netlify.app/.netlify/functions"},H=Ee;function Ae(t){let e,n,o,r;return{c(){e=p("div"),n=p("button"),n.textContent="Connect to Foursquare",$(n,"class","connect_button"),$(e,"class","connect_container")},m(c,s){k(c,e,s),d(e,n),o||(r=J(n,"click",t[0]),o=!0)},p:g,i:g,o:g,d(c){c&&b(e),o=!1,r()}}}function Ie(t){return[()=>{const n=`https://foursquare.com/oauth2/authenticate?client_id=${H.CLIENT_ID}&response_type=code&redirect_uri=${H.REDIRECT_URI}`;window.location.href=n}]}class Se extends V{constructor(e){super(),Q(this,e,Ie,Ae,W,{})}}function ne(t,e,n){const o=t.slice();return o[7]=e[n],o[9]=n,o}function Te(t){let e,n=te(t[0]),o=[];for(let r=0;r<n.length;r+=1)o[r]=re(ne(t,n,r));return{c(){e=p("div");for(let r=0;r<o.length;r+=1)o[r].c();$(e,"class","checkin_items")},m(r,c){k(r,e,c);for(let s=0;s<o.length;s+=1)o[s]&&o[s].m(e,null)},p(r,c){if(c&21){n=te(r[0]);let s;for(s=0;s<n.length;s+=1){const f=ne(r,n,s);o[s]?o[s].p(f,c):(o[s]=re(f),o[s].c(),o[s].m(e,null))}for(;s<o.length;s+=1)o[s].d(1);o.length=n.length}},d(r){r&&b(e),de(o,r)}}}function Pe(t){let e;return{c(){e=p("span"),e.textContent="loading..",$(e,"class","loading")},m(n,o){k(n,e,o)},p:g,d(n){n&&b(e)}}}function oe(t){let e,n,o=t[7].shout+"",r,c;return{c(){e=p("span"),n=A("「"),r=A(o),c=A("」"),$(e,"class","shout")},m(s,f){k(s,e,f),d(e,n),d(e,r),d(e,c)},p(s,f){f&1&&o!==(o=s[7].shout+"")&&j(r,o)},d(s){s&&b(e)}}}function Le(t){let e,n,o;function r(){return t[5](t[7])}return{c(){e=p("button"),e.textContent=`${t[2]}`,$(e,"class","share_button")},m(c,s){k(c,e,s),n||(o=J(e,"click",r),n=!0)},p(c,s){t=c},d(c){c&&b(e),n=!1,o()}}}function De(t){let e;return{c(){e=p("span"),e.textContent="非公開",$(e,"class","share_private")},m(n,o){k(n,e,o)},p:g,d(n){n&&b(e)}}}function re(t){let e,n,o=t[7].venue.name+"",r,c,s,f=t[7].appAddress+"",i,l,u,a=new Date(t[7].createdAt*1e3).toLocaleString("ja-JP",{timeZone:"Asia/Tokyo"})+"",h,y,C,w,m=t[7].shout!=null&&oe(t);function z(_,E){return _[7].appPrivate?De:Le}let U=z(t),v=U(t);return{c(){e=p("div"),n=p("span"),r=A(o),c=I(),s=p("span"),i=A(f),l=I(),u=p("span"),h=A(a),y=I(),m&&m.c(),C=I(),v.c(),w=I(),$(n,"class","venue_name"),$(s,"class","venue_address"),$(u,"class","checkin_at"),$(e,"class","checkin_item")},m(_,E){k(_,e,E),d(e,n),d(n,r),d(e,c),d(e,s),d(s,i),d(e,l),d(e,u),d(u,h),d(e,y),m&&m.m(e,null),d(e,C),v.m(e,null),d(e,w)},p(_,E){E&1&&o!==(o=_[7].venue.name+"")&&j(r,o),E&1&&f!==(f=_[7].appAddress+"")&&j(i,f),E&1&&a!==(a=new Date(_[7].createdAt*1e3).toLocaleString("ja-JP",{timeZone:"Asia/Tokyo"})+"")&&j(h,a),_[7].shout!=null?m?m.p(_,E):(m=oe(_),m.c(),m.m(e,C)):m&&(m.d(1),m=null),U===(U=z(_))&&v?v.p(_,E):(v.d(1),v=U(_),v&&(v.c(),v.m(e,w)))},d(_){_&&b(e),m&&m.d(),v.d()}}}function Ne(t){let e,n,o,r,c;function s(l,u){return l[1]?Pe:Te}let f=s(t),i=f(t);return{c(){i.c(),e=I(),n=p("div"),o=p("button"),o.textContent="Disconnect",$(o,"class","disconnect_button"),$(n,"class","footer")},m(l,u){i.m(l,u),k(l,e,u),k(l,n,u),d(n,o),r||(c=J(o,"click",t[3]),r=!0)},p(l,[u]){f===(f=s(l))&&i?i.p(l,u):(i.d(1),i=f(l),i&&(i.c(),i.m(e.parentNode,e)))},i:g,o:g,d(l){l&&(b(e),b(n)),i.d(l),r=!1,c()}}}function Fe(t,e,n){var u;const o=localStorage.getItem("sci_accessToken"),r=((u=window.navigator)==null?void 0:u.canShare)!=null?"Share...":"Copy to clipboard";let c=[],s=!0;me(async()=>{console.log("onMount");try{const a=await fetch(`https://api.foursquare.com/v2/users/self/checkins?oauth_token=${o}&v=20230823&limit=100`);if(!a.ok){f();return}const h=await a.json();n(0,c=h.response.checkins.items),c.map(y=>{y.appAddress=`${y.venue.location.city}, ${y.venue.location.state}`,y.appPrivate=y.visibility==="private"})}finally{n(1,s=!1)}});const f=()=>{confirm("Foursquare から切断しますか？")&&(localStorage.removeItem("sci_accessToken"),window.location.href="./")},i=a=>{(async()=>{const h=await fetch(`https://api.foursquare.com/v2/checkins/${a.id}?oauth_token=${o}&v=20230823`).then(w=>w.json()),C=`${a.shout==null?"":`${a.shout} / `}I'm at ${a.venue.name} in ${a.appAddress} ${h.response.checkin.checkinShortUrl}`;if(!window.navigator.canShare){const w=prompt("クリップボードにコピーしますか？",C);w!=null&&await navigator.clipboard.writeText(w);return}try{await window.navigator.share({text:C})}catch(w){console.log(w)}})()};return[c,s,r,f,i,a=>i(a)]}class Oe extends V{constructor(e){super(),Q(this,e,Fe,Ne,W,{})}}function Re(t){let e,n;return e=new Oe({}),{c(){le(e.$$.fragment)},m(o,r){X(e,o,r),n=!0},p:g,i(o){n||(D(e.$$.fragment,o),n=!0)},o(o){O(e.$$.fragment,o),n=!1},d(o){K(e,o)}}}function Ue(t){let e,n,o,r;const c=[Be,je],s=[];function f(i,l){return i[1]==null?0:1}return e=f(t),n=s[e]=c[e](t),{c(){n.c(),o=pe()},m(i,l){s[e].m(i,l),k(i,o,l),r=!0},p:g,i(i){r||(D(n),r=!0)},o(i){O(n),r=!1},d(i){i&&b(o),s[e].d(i)}}}function je(t){let e;return{c(){e=p("span"),e.textContent="Connecting..."},m(n,o){k(n,e,o)},i:g,o:g,d(n){n&&b(e)}}}function Be(t){let e,n;return e=new Se({}),{c(){le(e.$$.fragment)},m(o,r){X(e,o,r),n=!0},i(o){n||(D(e.$$.fragment,o),n=!0)},o(o){O(e.$$.fragment,o),n=!1},d(o){K(e,o)}}}function xe(t){let e,n,o,r,c,s;const f=[Ue,Re],i=[];function l(u,a){return u[0]==null?0:1}return r=l(t),c=i[r]=f[r](t),{c(){e=p("main"),n=p("h1"),n.textContent="SHARE I'M AT",o=I(),c.c()},m(u,a){k(u,e,a),d(e,n),d(e,o),i[r].m(e,null),s=!0},p(u,[a]){let h=r;r=l(u),r===h?i[r].p(u,a):(ke(),O(i[h],1,1,()=>{i[h]=null}),we(),c=i[r],c?c.p(u,a):(c=i[r]=f[r](u),c.c()),D(c,1),c.m(e,null))},i(u){s||(D(c),s=!0)},o(u){O(c),s=!1},d(u){u&&b(e),i[r].d()}}}function Me(t,e,n){let o=localStorage.getItem("sci_accessToken");const c=new URLSearchParams(window.location.search).get("code");return o!=null||(c?(async()=>{const f=await(await fetch(`${H.API_ENDPOINT}/token?code=${c}`)).json(),i=new URL(window.location.href),l=new URLSearchParams(i.search);l.delete("code"),i.hash="",i.search=l.toString(),history.replaceState(null,"",i.toString()),n(0,o=f.access_token),o!=null&&localStorage.setItem("sci_accessToken",o)})():localStorage.removeItem("sci_accessToken")),[o,c]}class qe extends V{constructor(e){super(),Q(this,e,Me,xe,W,{})}}new qe({target:document.getElementById("app")});
